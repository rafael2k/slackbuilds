--- hydrogen-0.9.3/src/lib/xml/tinyxml.h~	2006-03-15 15:43:13.000000000 +0000
+++ hydrogen-0.9.3/src/lib/xml/tinyxml.h	2006-03-15 15:43:33.000000000 +0000
@@ -823,9 +823,9 @@
 #endif
 
 	/// Construct.
-	TiXmlDeclaration::TiXmlDeclaration( const char * _version,
-										const char * _encoding,
-										const char * _standalone );
+	TiXmlDeclaration( const char * _version,
+				const char * _encoding,
+				const char * _standalone );
 
 	virtual ~TiXmlDeclaration()	{}
 

--- hydrogen-0.9.3/src/tools/HydrogenPlayer.cpp~	2007-04-01 21:01:06.000000000 +0000
+++ hydrogen-0.9.3/src/tools/HydrogenPlayer.cpp	2007-04-01 21:01:28.000000000 +0000
@@ -25,6 +25,7 @@
 
 #include <qapplication.h>
 
+#include <cstdlib>
 #include <iostream>
 #include <stdio.h>
 #include <string>
--- hydrogen-0.9.3/src/gui/DrumkitManager.cpp~	2007-04-01 21:03:50.000000000 +0000
+++ hydrogen-0.9.3/src/gui/DrumkitManager.cpp	2007-04-01 21:03:58.000000000 +0000
@@ -22,6 +22,7 @@
  *
  */
 #include <qcursor.h>
+#include <cstdlib>
 
 #include "config.h"
 #include "Skin.h"
--- hydrogen-0.9.3/src/gui/HydrogenApp.cpp~	2007-04-01 21:04:29.000000000 +0000
+++ hydrogen-0.9.3/src/gui/HydrogenApp.cpp	2007-04-01 21:04:37.000000000 +0000
@@ -46,6 +46,7 @@
 #include "LadspaFXProperties.h"
 #include "SongEditor/SongEditorPanel.h"
 
+#include <cstdlib>
 #include <qdockwindow.h>
 #include <qsplitter.h>
 #include <qhbox.h>
--- hydrogen-0.9.3/src/gui/main.cpp~	2007-04-01 21:05:56.000000000 +0000
+++ hydrogen-0.9.3/src/gui/main.cpp	2007-04-01 21:06:04.000000000 +0000
@@ -42,6 +42,7 @@
 #include "lib/DataPath.h"
 #include "lib/Exception.h"
 
+#include <cstdlib>
 #include <iostream>
 using namespace std;

--- hydrogen-0.9.3/src/lib/FLACFile.cpp
+++ hydrogen-0.9.3/src/lib/FLACFile.cpp
@@ -39,6 +39,8 @@
 #undef LEGACY_FLAC
 #endif
 
+#include <cstring>
+
 
 /// Reads a FLAC file...not optimized yet
 class FLACFile_real : public FLAC::Decoder::File, public Object
--- hydrogen-0.9.3/src/lib/drivers/OssDriver.cpp
+++ hydrogen-0.9.3/src/lib/drivers/OssDriver.cpp
@@ -31,6 +31,8 @@
 
 #include <pthread.h>
 
+#include <cstring>
+
 audioProcessCallback ossDriver_audioProcessCallback;
 bool ossDriver_running;
 pthread_t ossDriverThread;
--- hydrogen-0.9.3/src/lib/FLACFile.cpp.old	2007-02-11 20:12:34.000000000 +0100
+++ hydrogen-0.9.3/src/lib/FLACFile.cpp	2007-02-11 20:18:25.000000000 +0100
@@ -33,6 +33,13 @@
 //#include "FLAC/file_decoder.h"
 #include <FLAC++/all.h>
 
+#if !defined(FLAC_API_VERSION_CURRENT) || FLAC_API_VERSION_CURRENT < 8
+#define LEGACY_FLAC
+#else
+#undef LEGACY_FLAC
+#endif
+
+
 /// Reads a FLAC file...not optimized yet
 class FLACFile_real : public FLAC::Decoder::File, public Object
 {
@@ -164,16 +171,28 @@
 	}
 
 	set_metadata_ignore_all();
+
+#ifdef LEGACY_FLAC
 	set_filename( sFilename.c_str() );
 
 	State s=init();
 	if( s != FLAC__FILE_DECODER_OK ) {
+#else
+	FLAC__StreamDecoderInitStatus s=init(sFilename.c_str() );
+	if(s!=FLAC__STREAM_DECODER_INIT_STATUS_OK) {
+#endif
 		errorLog( "[load] Error in init()" );
 	}
 
+#ifdef LEGACY_FLAC
 	if ( process_until_end_of_file() == false ) {
 		errorLog( "[load] Error in process_until_end_of_file()" );
 	}
+#else
+	if ( process_until_end_of_stream() == false ) {
+		errorLog( "[load] Error in process_until_end_of_stream()" );
+	}
+#endif
 }
 
--- a/hydrogen-0.9.3/data/demo_songs/TR808kit-demo.h2song	2005-10-18 00:32:04.000000000 +0200
+++ b/hydrogen-0.9.3/data/demo_songs/TR808kit-demo.h2song	2007-06-05 15:33:19.000000000 +0200
@@ -1,5 +1,5 @@
 <song>
-    <version>0.9.2-cvs</version>
+    <version>0.9.3</version>
     <bpm>125</bpm>
     <volume>0.71</volume>
     <metronomeVolume>0.5</metronomeVolume>
@@ -7,10 +7,14 @@
     <author>ArtemioLabs</author>
     <notes>Demo patterns for the TR-808 Emulation Kit.</notes>
     <loopEnabled>true</loopEnabled>
-    <mode>song</mode>
+    <mode>pattern</mode>
     <humanize_time>0</humanize_time>
     <humanize_velocity>0</humanize_velocity>
     <swing_factor>0</swing_factor>
+    <delayFXEnabled>false</delayFXEnabled>
+    <delayFXWetLevel>1</delayFXWetLevel>
+    <delayFXFeedback>0.4</delayFXFeedback>
+    <delayFXTime>48</delayFXTime>
     <instrumentList>
         <instrument>
             <id>0</id>
@@ -18,8 +22,10 @@
             <name>Kick Long</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -44,8 +50,10 @@
             <name>Kick Short</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -70,8 +78,10 @@
             <name>Snare 1</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -96,8 +106,10 @@
             <name>Snare 2</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -122,8 +134,10 @@
             <name>Clap</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -148,8 +162,10 @@
             <name>Tom Low</name>
             <volume>0.77</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>0.52</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -174,8 +190,10 @@
             <name>Tom Mid</name>
             <volume>0.79</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -200,8 +218,10 @@
             <name>Tom Hi</name>
             <volume>0.79</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>0.48</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -226,8 +246,10 @@
             <name>Closed Hat</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -252,8 +274,10 @@
             <name>Pedal Hat</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -278,8 +302,10 @@
             <name>Open Hat</name>
             <volume>1</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -304,8 +330,10 @@
             <name>Cymbal</name>
             <volume>0.82</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -330,8 +358,10 @@
             <name>Shaker</name>
             <volume>0.84</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -356,8 +386,10 @@
             <name>Conga</name>
             <volume>0.88</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>0.9</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -382,8 +414,10 @@
             <name>Clave</name>
             <volume>0.84</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>0.96</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -408,8 +442,10 @@
             <name>Cowbell</name>
             <volume>0.85</volume>
             <isMuted>false</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>0.96</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -434,8 +470,10 @@
             <name>17</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -453,8 +491,10 @@
             <name>18</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -472,8 +512,10 @@
             <name>19</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -491,8 +533,10 @@
             <name>20</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -510,8 +554,10 @@
             <name>21</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -529,8 +575,10 @@
             <name>22</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -548,8 +596,10 @@
             <name>23</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -567,8 +617,10 @@
             <name>24</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -586,8 +638,10 @@
             <name>25</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -605,8 +659,10 @@
             <name>26</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -624,8 +680,10 @@
             <name>27</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -643,8 +701,10 @@
             <name>28</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -662,8 +722,10 @@
             <name>29</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -681,8 +743,10 @@
             <name>30</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -700,8 +764,10 @@
             <name>31</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -719,8 +785,10 @@
             <name>32</name>
             <volume>0.8</volume>
             <isMuted>true</isMuted>
+            <isLocked>false</isLocked>
             <pan_L>1</pan_L>
             <pan_R>1</pan_R>
+            <gain>1</gain>
             <FX1Level>0</FX1Level>
             <FX2Level>0</FX2Level>
             <FX3Level>0</FX3Level>
@@ -1602,15 +1670,6 @@
                             <length>-1</length>
                             <instrument>9</instrument>
                         </note>
-                        <note>
-                            <position>168</position>
-                            <velocity>0.8</velocity>
-                            <pan_L>1</pan_L>
-                            <pan_R>1</pan_R>
-                            <pitch>0</pitch>
-                            <length>-1</length>
-                            <instrument>9</instrument>
-                        </note>
                     </noteList>
                 </sequence>
                 <sequence>
@@ -1792,7 +1851,17 @@
                     <noteList />
                 </sequence>
                 <sequence>
-                    <noteList />
+                    <noteList>
+                        <note>
+                            <position>156</position>
+                            <velocity>0.8</velocity>
+                            <pan_L>1</pan_L>
+                            <pan_R>1</pan_R>
+                            <pitch>0</pitch>
+                            <length>-1</length>
+                            <instrument>26</instrument>
+                        </note>
+                    </noteList>
                 </sequence>
                 <sequence>
                     <noteList />

